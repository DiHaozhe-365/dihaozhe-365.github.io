<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>第三章 Tag 文件与 Tag 标记 | 邸浩哲Geo</title><meta name="keywords" content="邸浩哲, 博客, 分享, 生活, 科技"><meta name="author" content="邸浩哲Geo"><meta name="copyright" content="邸浩哲Geo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#18171d"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="第三章 Tag 文件与 Tag 标记"><meta name="application-name" content="第三章 Tag 文件与 Tag 标记"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#18171d"><meta property="og:type" content="website"><meta property="og:title" content="第三章 Tag 文件与 Tag 标记"><meta property="og:url" content="http://dihaozhe.com/note/note_3_backend/3.jsp/3.html"><meta property="og:site_name" content="邸浩哲Geo"><meta property="og:description" content="3.1 Tag 文件Tag 文件的结构Tag 文件是扩展名为 .tag 的文本文件，其结构和 JSP 文件类似。 一个 Tag 文件中可以包含：  普通的 HTML 标记符 某些特殊的指令标记 成员变量声明和方法的定义 Java 程序片和 Java 表达式  以下是一个简单的 Tag 文件 oddN"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://pic.imgdb.cn/item/64f97fcf661c6c8e544e533e.jpg"><meta property="article:author" content="邸浩哲Geo"><meta property="article:tag" content="邸浩哲, 博客, 分享, 生活, 科技"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://pic.imgdb.cn/item/64f97fcf661c6c8e544e533e.jpg"><meta name="description" content="3.1 Tag 文件Tag 文件的结构Tag 文件是扩展名为 .tag 的文本文件，其结构和 JSP 文件类似。 一个 Tag 文件中可以包含：  普通的 HTML 标记符 某些特殊的指令标记 成员变量声明和方法的定义 Java 程序片和 Java 表达式  以下是一个简单的 Tag 文件 oddN"><link rel="shortcut icon" href="https://pic.imgdb.cn/item/64f98091661c6c8e544e8413.webp"><link rel="canonical" href="http://dihaozhe.com/note/note_3_backend/3.jsp/3"><link rel="preconnect" href="//npm.elemecdn.com"/><link rel="preconnect" href="//npm.onmicrosoft.cn"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"与博主们无限进步","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（博客首页地址）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n"},
  postHeadAiDescription: {"enable":true,"gptName":"邸浩哲Geo","mode":"tianli","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"13cdf7208b778fc7b4bb","Referer":"https://dihaozhe.com"},
  diytitle: undefined,
  LA51: {"enable":true,"ck":"3FpeCk9AnAHhM8vm","LingQueMonitorID":"3FpeORNir8WHNOiM"},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://dihaozhe.zeabur.app',
  commentBarrageConfig:{"enable":true,"maxBarrage":1,"barrageTime":4000,"accessToken":"","mailMd5":""},
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: {"mode":"api","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🧱 团队小组发动机"]},
  algolia: {"appId":"55GLTQ5T7S","apiKey":"6289356dfa814c630ee23c43df7fd008","indexName":"hexo","hits":{"per_page":6},"languages":{"input_placeholder":"输入关键词后按下回车查找","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 邸浩哲Geo","link":"链接: ","source":"来源: 邸浩哲Geo","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#3b70fc","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: {"enable":true,"delay":100,"shiftDelay":200},
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '邸浩哲Geo',
  title: '第三章 Tag 文件与 Tag 标记',
  postAI: '',
  pageFillDescription: '3.1 Tag 文件, Tag 文件的结构, Tag 文件的保存, 3.2 Tag 标记, Tag 标记与 Tag 文件, Tag 标记的使用, Tag 标记的运行原理, 3.3 Tag 文件中的常用指令, tag 指令, include 指令, attribute 指令, variable 指令, taglib 指令, 习题 3文件文件的结构文件是扩展名为的文本文件其结构和文件类似一个文件中可以包含普通的标记符某些特殊的指令标记成员变量声明和方法的定义程序片和表达式以下是一个简单的文件负责计算内的全部奇数的代数和宋体内的奇数之和文件的保存文件所在目录文件可以实现代码的复用即文件可以被许多页面使用为了能让一个应用中的页面使用某一个文件必须把这个文件存放到服务器指定的目录中也就是说如果某个服务目录下的页面准备调用一个文件那么必须在该服务目录下建立如下的目录结构服务目录其中的和都是固定的目录名称而下的子目录名称可以任意给定一个文件必须保存到目录或其下的子目录中文件的编码保存文件时按照文件指定的编码保存例如文件使用指令标记标记与文件某个服务目录下的文件只能由该服务目录中的页面调用页面必须通过标记来调用一个文件标记的名字和文件的名字一致也就是说当我们编写了一个文件并保存到特定目录中后也就给出了一个标记该标记的格式为文件的名字或者文件的名字其他内容称为标体内容文件的名字一个文件对应着一个标记把全体标记称之为一个自定义标记库或简称为标记库标记的使用一个页面通过使用标记来调用一个文件服务目录下的一个页面在使用标记来调用一个文件之前必须首先使用指令标记引入该服务目录下的标记库只有这样页面才可以使用标记调用相应的文件指令的格式如下标记库的位置前缀例如引入标记库后页面就可以使用带前缀的标记调用相应的文件其中的前缀由指令中的属性指定例如如下使用标记调用相应的文件指令中的给出的前缀由用户自定义其好处是通过前缀可以有效地区分不同标记库中具有相同名字的标记文件以下页面使用了标记调用文件用来计算之内的奇数之和调用文件计算内的奇数之和使用标记标记的运行原理服务器处理页面中的标记的原理如下如果该标记对应的文件是首次被页面调用那么服务器会将文件转译成一个文件并编译这个文件生成字节码文件然后执行这个字节码文件这和执行页面的原理类似如果该文件已经被转编译为字节码文件服务器将直接执行这个字节码文件如果对文件进行了修改那么服务器会重新将文件转译成一个文件并编译这个文件生成字节码文件然后执行这个字节码文件文件中的常用指令与文件类似文件中也有一些常用指令这些指令将影响文件的行为文件中经常使用的指令有指令文件中的指令类似于文件中的指令文件通过指令可以指定某些属性的值以便从总体上影响文件的处理和表示指令的语法如下属性属性的值属性属性的值属性属性的值或者属性属性的值属性属性的值属性属性的值属性在文件中指令的属性的默认值是因此为了避免显示信息出现乱码现象文件必须将该属性值设置为属性属性定义页面使用的脚本语言该属性的值目前只能取其默认值就是因此没有必要在编写文件时特意指定为属性指定值的格式是属性该属性的作用是为页面引入运行环境提供的包中的类这样就可以在页面的程序片部分变量及方法定义部分以及表达式部分使用包中的类可以为该属性指定多个值该属性的值可以是某包中的所有类或一个具体的类例如这样引擎把页面转译成的文件中会有如下的语句属性默认已经有如下值指令在文件中也有和文件类似的指令标记其使用方法和作用与文件中的指令标记类似指令在文件中通过使用指令让使用它的页面向该文件传递需要的数据指令的格式如下对象名字对象的类型例如此时该文件需要等待调用它的页面将一个类型的对象的引用传递给页面需要使用以下格式来传递引用前缀文件名字对象名字对象的引用指令文件通过使用指令可以使得调用该文件的页面动态地向其传递数据在某些应用中页面不仅希望向文件传递数据而且希望文件能返回数据给页面比如许多页面可能都需要调用某个文件对某些数据进行基本的处理但不希望文件做进一步的特殊处理以及显示数据因为各个页面对数据的进一步处理或显示格式的要求是不同的因此页面希望文件将数据的基本处理结果存放在某些对象中将这些对象返回给当前页面即可文件通过使用指令可以将文件中的对象返回给调用该文件的页面指令的格式如下对象名对象类型有效范围的值就是文件返回给页面的对象该对象的名字必须符合标识符规定即名字可以由字母下划线美元符号和数字组成并且第一个字符不能是数字字符的值是返回的对象的类型对象的类型必须带有包名比如等类型如果指令中没有使用给出对象的类型那么对象的类型是类型属性的值指定对象的有效范围的值可以取和当的值是时页面一旦开始使用标记就得到了指令返回给页面的对象页面就可以在标记的标记体中或标记结束后的各个部分中使用指令返回给页面的对象当的值是时页面只可以在标记的标记体中使用指令返回给页面的对象当的值是时页面只可以在标记结束后才可以使用指令返回给页面的对象下面的指令给出的对象的名字是类型为有效范围是对象的返回文件为了给页面返回一个对象就必须将返回的对象的名字以及该对象的引用存储到服务器提供的内置对象中文件只有将对象的名字及其引用存储到中页面才可以使用该对象比如文件的指令为页面返回名字是的对象那么文件中必须让调用方法存储名字是的对象以及该对象的引用例如将名字是的对象存储到中指令页面和页面都可以使用指令引入标记库标记库的位置前缀可以引入多个标记库标记库的位置前缀标记库的位置前缀标记库的位置前缀习题用户可以使用浏览器直接访问一个文件吗查看答案答文件和文件很类似可以被文件动态加载调用但是用户不能直接访问文件文件应当存放在怎样的目录中查看答案答文件的保存位置为目录下的目录及其子目录中文件中的指令可以设置哪些属性的值查看答案答指令可以设置等属性的值文件中的指令有怎样的作用查看答案答在文件中通过使用指令让使用它的页面向该文件传递需要的数据文件中的指令有怎样的作用查看答案答文件通过使用指令可以将文件中的对象返回给调用该文件的页面编写两个文件和负责计算并显示矩形的面积负责计算并显示圆的面积编写一个页面该页面使用标记调用和调用时向其传递矩形的两个边的长度调用时向其传递圆的半径查看答案答代码如下请输入矩形的长宽和圆的半径长宽半径计算矩形面积圆形面积运行截图编写一个文件负责求出三角形的面积并使用指令返回三角形的面积给调用该文件的页面页面负责显示文件返回的三角形的面积在调用文件时使用指令将三角形三边的长度传递给文件和都使用标记调用返回的三角形的面积保留最多位小数返回的三角形的面积保留最多位小数查看答案答代码如下请输入三角形三边长计算结果最多保留位小数请输入三角形三边长计算结果最多保留位小数运行截图返回目录上一章下一章',
  isPost: false,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-09-12 16:47:05',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://pic.imgdb.cn/item/64f97fcf661c6c8e544e533e.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="page" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网站</div><div class="back-menu-list"><a class="back-menu-item" href="https://dihaozhe.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.imgdb.cn/item/64f98091661c6c8e544e8413.webp" alt="博客"/><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="http://star-di.com:8080/BasedOnWebProgramming_war_exploded/" title="JSP 程序设计"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.imgdb.cn/item/65016a12661c6c8e546c4a0e.webp" alt="JSP 程序设计"/><span class="back-menu-item-text">JSP 程序设计</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">邸浩哲Geo</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文库</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 文章总览</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 全部分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 学习</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/note/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 笔记仓库</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 生活</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=9013145695&amp;server=tencent"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 社交</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友情链接</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-shoe-prints faa-tada" style="font-size: 0.9em;"></i><span> 到此一游</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-bullhorn faa-tada" style="font-size: 0.9em;"></i><span> 即刻短文</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-keyboard faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button" title="随机前往一个文章"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button" title="搜索文章🔍"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索文章🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" title="打开中控台" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://pic.imgdb.cn/item/64f98092661c6c8e544e84e6.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.imgdb.cn/item/64f98092661c6c8e544e84e6.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://pic.imgdb.cn/item/64f980fb661c6c8e544ee38d.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.imgdb.cn/item/64f980fb661c6c8e544ee38d.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/IDEA/" style="font-size: 1.05rem;">IDEA<sup>1</sup></a><a href="/tags/IDEA-%E6%8F%92%E4%BB%B6/" style="font-size: 1.05rem;">IDEA 插件<sup>1</sup></a><a href="/tags/JDK/" style="font-size: 1.05rem;">JDK<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>1</sup></a><a href="/tags/Tomcat/" style="font-size: 1.05rem;">Tomcat<sup>1</sup></a><a href="/tags/%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" style="font-size: 1.05rem;">安装教程<sup>2</sup></a><a href="/tags/%E8%8B%B1%E8%AF%AD%E6%96%87%E5%AD%A6/" style="font-size: 1.05rem;">英语文学<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div><div class="console-btn-item" id="consoleKeyboard" onclick="anzhiyu.keyboardToggle()" title="快捷键开关"><a class="keyboard-switch"><i class="anzhiyufont anzhiyu-icon-keyboard"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav></header><main id="blog-container"><div class="layout" id="content-inner"><div id="page"><h1 class="page-title">第三章 Tag 文件与 Tag 标记</h1><div id="article-container"><h2 id="3-1-Tag-文件"><a href="#3-1-Tag-文件" class="headerlink" title="3.1 Tag 文件"></a>3.1 Tag 文件</h2><h3 id="Tag-文件的结构"><a href="#Tag-文件的结构" class="headerlink" title="Tag 文件的结构"></a>Tag 文件的结构</h3><p>Tag 文件是扩展名为 <code>.tag</code> 的文本文件，其结构和 JSP 文件类似。</p>
<p>一个 Tag 文件中可以包含：</p>
<ul>
<li>普通的 HTML 标记符</li>
<li>某些特殊的指令标记</li>
<li>成员变量声明和方法的定义</li>
<li>Java 程序片和 Java 表达式</li>
</ul>
<p>以下是一个简单的 Tag 文件 <code>oddNumberSum.tag</code>，负责计算 100 内的全部奇数的代数和。</p>
<p><strong>oddNumberSum.tag</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ tag pageEncoding=&quot;utf-8&quot; %&gt;</span><br><span class="line">&lt;p style=&quot;font-family: 宋体;font-size: 36&quot;&gt;</span><br><span class="line">1~100 内的奇数之和：</span><br><span class="line">&lt;%</span><br><span class="line">    int sum = 0,i = 1;</span><br><span class="line">    for(i = 1; i &lt;= 100; i++)&#123;</span><br><span class="line">        if(i % 2 == 1)&#123;</span><br><span class="line">            sum = sum + i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    out.println(sum);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/p&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Tag-文件的保存"><a href="#Tag-文件的保存" class="headerlink" title="Tag 文件的保存"></a>Tag 文件的保存</h3><p><strong>Tag 文件所在目录</strong></p>
<p>Tag 文件可以实现代码的复用，即 Tag 文件可以被许多 JSP 页面使用。为了能让一个 Web 应用中的 JSP 页面使用某一个 Tag 文件，必须把这个 Tag 文件存放到 Tomcat 服务器指定的目录中。</p>
<p>也就是说，如果某个 Web 服务目录下的 JSP 页面准备调用一个 Tag 文件，那么必须在该 Web 服务目录下，建立如下的目录结构：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Web 服务目录\WEB-INF\tags\</span><br></pre></td></tr></table></figure>

<p>其中的 WEB-INF 和 tags 都是固定的目录名称，而 tags 下的子目录名称可以任意给定。</p>
<p>一个 Tag 文件必须保存到 tags 目录或其下的子目录中。</p>
<p><strong>Tag 文件的编码</strong></p>
<p>保存 Tag 文件时按照 Tag 文件指定的编码保存，例如 Tag 文件使用 <code>tag</code> 指令：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ tag pageEncoding=<span class="string">&quot;utf-8&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>

<h2 id="3-2-Tag-标记"><a href="#3-2-Tag-标记" class="headerlink" title="3.2 Tag 标记"></a>3.2 Tag 标记</h2><h3 id="Tag-标记与-Tag-文件"><a href="#Tag-标记与-Tag-文件" class="headerlink" title="Tag 标记与 Tag 文件"></a>Tag 标记与 Tag 文件</h3><p>某个 Web 服务目录下的 Tag 文件只能由该 Web 服务目录中的 JSP 页面调用，JSP 页面必须通过 <code>Tag</code> 标记来调用一个 Tag 文件。</p>
<p><code>Tag</code> 标记的名字和 Tag 文件的名字一致，也就是说，当我们编写了一个 Tag 文件并保存到特定目录中后，也就给出了一个 <code>Tag</code> 标记，该标记的格式为：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Tag文件的名字/&gt;</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Tag文件的名字&gt;其他内容（称为标体内容）&lt;/Tag文件的名字&gt;</span><br></pre></td></tr></table></figure>

<p>一个 Tag 文件对应着一个 <code>Tag</code> 标记，把全体 <code>Tag</code> 标记称之为一个<strong>自定义标记库</strong>或简称为<strong>标记库</strong>。</p>
<h3 id="Tag-标记的使用"><a href="#Tag-标记的使用" class="headerlink" title="Tag 标记的使用"></a>Tag 标记的使用</h3><p>一个 JSP 页面通过使用 <code>Tag</code> 标记来调用一个 Tag 文件。Web 服务目录下的一个 JSP 页面在使用 <code>Tag</code> 标记来调用一个 Tag 文件之前，必须首先使用 <code>taglib</code> 指令标记引入该 Web 服务目录下的标记库，只有这样，JSP 页面才可以使用 Tag 标记调用相应的 Tag 文件。</p>
<p><code>taglib</code> 指令的格式如下：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib tagdir=<span class="string">&quot;标记库的位置&quot;</span> prefix=<span class="string">&quot;前缀&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib tagdir=<span class="string">&quot;/WEB-INF/tags&quot;</span> prefix=<span class="string">&quot;computer&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>

<p>引入标记库后，JSP 页面就可以使用带前缀的 <code>Tag</code> 标记调用相应的 Tag 文件，其中的前缀由 <code>&lt;taglib&gt;</code> 指令中的 <code>prefix</code> 属性指定。例如 JSP 如下使用 <code>Tag</code> 标记调用相应的 Tag 文件：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;computer:oddNumberSum/&gt;</span><br></pre></td></tr></table></figure>

<p><code>taglib</code> 指令中的 <code>prefix</code> 给出的前缀由用户自定义，其好处是，通过前缀可以有效地区分不同标记库中具有相同名字的标记文件。</p>
<p>以下 JSP 页面使用了 <code>Tag</code> 标记调用 <code>oddNumberSum.tag</code> 文件，用来计算 1~100 之内的奇数之和：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page pageEncoding=<span class="string">&quot;utf-8&quot;</span> %&gt;</span><br><span class="line">&lt;%@ taglib tagdir=<span class="string">&quot;/WEB-INF/tags&quot;</span> prefix=<span class="string">&quot;computer&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;body background=cyan&gt;</span><br><span class="line">        &lt;h1&gt;调用 Tag 文件计算 <span class="number">1</span>~<span class="number">100</span> 内的奇数之和&lt;/h1&gt;</span><br><span class="line">        &lt;computer:oddNumberSum/&gt;&lt;%-- 使用 Tag 标记 --%&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Tag-标记的运行原理"><a href="#Tag-标记的运行原理" class="headerlink" title="Tag 标记的运行原理"></a>Tag 标记的运行原理</h3><p>Tomcat 服务器处理 JSP 页面中的 <code>Tag</code> 标记的原理如下：</p>
<ul>
<li>如果该 <code>Tag</code> 标记对应的 Tag 文件是首次被 JSP 页面调用，那么 Tomcat 服务器会将 Tag 文件转译成一个 Java 文件，并编译这个 Java 文件生成字节码文件，然后执行这个字节码文件（这和执行 JSP 页面的原理类似）。</li>
<li>如果该 Tag 文件已经被转编译为字节码文件，Tomcat 服务器将直接执行这个字节码文件。</li>
<li>如果对 Tag 文件进行了修改，那么 Tomcat 服务器会重新将 Tag 文件转译成一个 Java 文件，并编译这个 Java 文件生成字节码文件，然后执行这个字节码文件。</li>
</ul>
<h2 id="3-3-Tag-文件中的常用指令"><a href="#3-3-Tag-文件中的常用指令" class="headerlink" title="3.3 Tag 文件中的常用指令"></a>3.3 Tag 文件中的常用指令</h2><p>与 JSP 文件类似，Tag 文件中也有一些常用指令，这些指令将影响 Tag 文件的行为。Tag 文件中经常使用的指令有 <code>tag</code>、<code>taglib</code>、<code>include</code>、<code>attribute</code>、<code>variable</code>。</p>
<h3 id="tag-指令"><a href="#tag-指令" class="headerlink" title="tag 指令"></a>tag 指令</h3><p>Tag 文件中的 <code>tag</code> 指令类似于 JSP 文件中的 <code>page</code> 指令。Tag 文件通过 <code>tag</code> 指令可以指定某些属性的值，以便从总体上影响 Tag 文件的处理和表示。</p>
<p><code>tag</code> 指令的语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ tag 属性1=&quot;属性1的值&quot; 属性2=&quot;属性2的值&quot; ... 属性n=&quot;属性n的值&quot; %&gt;</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ tag 属性1=&quot;属性1的值&quot; %&gt;</span><br><span class="line">&lt;%@ tag 属性2=&quot;属性2的值&quot; %&gt;</span><br><span class="line">...</span><br><span class="line">&lt;%@ tag 属性n=&quot;属性n的值&quot; %&gt;</span><br></pre></td></tr></table></figure>

<p><strong>pageEncoding 属性</strong></p>
<p>在 Tag 文件中，<code>tag</code> 指令的 <code>pageEncoding</code> 属性的默认值是 ISO-8859-1。</p>
<p>因此，为了避免显示信息出现乱码现象，Tag 文件必须将该属性值设置为 UTF-8。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ tag pageEncoding=&quot;utf-8&quot; %&gt;</span><br></pre></td></tr></table></figure>

<p><strong>language 属性</strong></p>
<p><code>language</code> 属性定义 Tag 页面使用的脚本语言，该属性的值目前只能取 java。其默认值就是 java，因此没有必要在编写 Tag 文件时特意指定。</p>
<p>为 <code>language</code> 属性指定值的格式是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ tag language=&quot;java&quot; %&gt;</span><br></pre></td></tr></table></figure>

<p><strong>import 属性</strong></p>
<p>该属性的作用是为Tag 页面引入 Java 运行环境提供的包中的类，这样就可以在 Tag 页面的程序片部分、变量及方法定义部分以及表达式部分使用包中的类。可以为该属性指定多个值，该属性的值可以是某包中的所有类或一个具体的类，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ tag import=&quot;java.io.*&quot;,&quot;java.time.LocalDate&quot; %&gt;</span><br></pre></td></tr></table></figure>

<p>这样 JSP 引擎把 Tag 页面转译成的 Java 文件中会有如下的 <code>import</code> 语句：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br></pre></td></tr></table></figure>

<p><code>import</code> 属性默认已经有如下值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ tag import=&quot;java.lang.*&quot; %&gt;</span><br><span class="line">&lt;%@ tag import=&quot;javax.servlet.*&quot; %&gt;</span><br><span class="line">&lt;%@ tag import=&quot;javax.servlet.jsp.*&quot; %&gt;</span><br><span class="line">&lt;%@ tag import=&quot;javax.servlet.http.*&quot; %&gt;</span><br></pre></td></tr></table></figure>

<h3 id="include-指令"><a href="#include-指令" class="headerlink" title="include 指令"></a>include 指令</h3><p>在 Tag 文件中也有和 JSP 文件类似的 <code>include</code> 指令标记，其使用方法和作用与 JSP 文件中的 <code>include</code> 指令标记类似。</p>
<h3 id="attribute-指令"><a href="#attribute-指令" class="headerlink" title="attribute 指令"></a>attribute 指令</h3><p>在 Tag 文件中通过使用 <code>attribute</code> 指令让使用它的 JSP 页面向该 Tag 文件传递需要的数据。</p>
<p><code>attribute</code> 指令的格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ attribute name=&quot;对象名字&quot; required=&quot;true&quot;/&quot;false&quot; type=&quot;对象的类型&quot; %&gt;</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ attribute name=&quot;result&quot; required=&quot;true&quot; type=&quot;java.lang.Double&quot; %&gt;</span><br></pre></td></tr></table></figure>

<p>此时该 Tag 文件需要等待调用它的 JSP 页面将一个 Double 类型的对象的引用传递给 result。</p>
<p>JSP 页面需要使用以下格式来传递引用：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;前缀:Tag文件名字 对象名字=<span class="string">&quot;对象的引用&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<h3 id="variable-指令"><a href="#variable-指令" class="headerlink" title="variable 指令"></a>variable 指令</h3><p>Tag 文件通过使用 <code>attribute</code> 指令，可以使得调用该 Tag 文件的 JSP 页面动态地向其传递数据。在某些 Web 应用中，JSP 页面不仅希望向 Tag 文件传递数据，而且希望 Tag 文件能返回数据给 JSP 页面。比如，许多 JSP 页面可能都需要调用某个 Tag 文件对某些数据进行基本的处理，但不希望 Tag 文件做进一步的特殊处理以及显示数据，因为各个 JSP 页面对数据的进一步处理或显示格式的要求是不同的。因此，JSP 页面希望 Tag 文件将数据的基本处理结果存放在某些对象中，将这些对象返回给当前 JSP 页面即可。</p>
<p>Tag 文件通过使用 <code>variable</code> 指令可以将 Tag 文件中的对象返回给调用该 Tag 文件的 JSP 页面。</p>
<p><code>variable</code> 指令的格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ variable name-given=&quot;对象名&quot; variable-class=&quot;对象类型&quot; scope=&quot;有效范围&quot; %&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>name-given</code> 的值就是 Tag 文件返回给 JSP 页面的对象。该对象的名字必须符合标识符规定，即名字可以由字母、下划线、美元符号和数字组成，并且第一个字符不能是数字字符。</li>
<li><code>variable-class</code> 的值是返回的对象的类型，对象的类型必须带有包名，比如 java.lang.Double、java.time.LocalDate 等类型。如果 <code>variable</code> 指令中没有使用 <code>ariable-class</code> 给出对象的类型，那么对象的类型是 <code>java.lang.String</code> 类型。</li>
<li><code>scope</code> 属性的值指定对象的有效范围 <code>scope</code> 的值可以取 AT_BEGIN、NESTED 和 AT_END。<ul>
<li>当 <code>scope</code> 的值是 AT_BEGIN 时，JSP 页面一旦开始使用 Tag 标记，就得到了 <code>variable</code> 指令返回给 JSP 页面的对象，JSP 页面就可以在 Tag 标记的标记体中或 Tag 标记结束后的各个部分中使用 variable 指令返回给 JSP 页面的对象。</li>
<li>当 <code>scope</code> 的值是 NESTED 时，JSP 页面只可以在 Tag 标记的标记体中使用 <code>variable</code> 指令返回给 JSP 页面的对象。</li>
<li>当 <code>scope</code> 的值是 AT_END 时，JSP 页面只可以在 Tag 标记结束后。才可以使用 <code>variable</code> 指令返回给 JSP 页面的对象。</li>
</ul>
</li>
</ul>
<p>下面的 <code>variable</code> 指令给出的对象的名字是 time，类型为 java.time.LocalDate，有效范围是 AT_END：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ variable name-given=&quot;time&quot; variable-class=&quot;java.time.LocalDate&quot; scope=&quot;AT_END&quot; %&gt;</span><br></pre></td></tr></table></figure>

<p>对象的返回</p>
<p>Tag 文件为了给 JSP 页面返回一个对象，就必须将返回的对象的名字以及该对象的引用存储到 Tomcat 服务器提供的内置对象 jspContext 中。Tag 文件只有将对象的名字及其引用存储到 jspContext 中， JSP 页面才可以使用该对象。</p>
<p>比如，Tag 文件的 <code>variable</code> 指令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ variable name-given=&quot;time&quot; variable-class=&quot;java.time.LocalDate&quot; scope=&quot;AT_END&quot; %&gt;</span><br></pre></td></tr></table></figure>

<p>为 JSP 页面返回名字是 time 的 LocalDate 对象。那么 Tag 文件中必须让 jspContext 调用 <code>setAttribute()</code> 方法存储名字是 time 的对象以及该对象的引用。</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jspContext.setAttribute(&quot;time&quot;,LocalDate.now());</span><br></pre></td></tr></table></figure>

<p>将名字是 time 的 LocalDate 对象存储到 jspContext 中。</p>
<h3 id="taglib-指令"><a href="#taglib-指令" class="headerlink" title="taglib 指令"></a>taglib 指令</h3><p>JSP 页面和 Tag 页面都可以使用 <code>taglib</code> 指令引入标记库：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib tagdir=&quot;标记库的位置&quot; prefix=&quot;前缀&quot; %&gt;</span><br></pre></td></tr></table></figure>

<p>可以引入多个标记库：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib tagdir=&quot;标记库1的位置&quot; prefix=&quot;前缀1&quot; %&gt;</span><br><span class="line">&lt;%@ taglib tagdir=&quot;标记库2的位置&quot; prefix=&quot;前缀2&quot; %&gt;</span><br><span class="line">...</span><br><span class="line">&lt;%@ taglib tagdir=&quot;标记库n的位置&quot; prefix=&quot;前缀n&quot; %&gt;</span><br></pre></td></tr></table></figure>

<h2 id="习题-3"><a href="#习题-3" class="headerlink" title="习题 3"></a>习题 3</h2><ol>
<li><p><strong>用户可以使用浏览器直接访问一个 Tag 文件吗？</strong></p>
<div class="hide-block"><button type="button" class="hide-button" style="background-color:  green;">查看答案
    </button><div class="hide-content"><p>答：Tag 文件和 JSP 文件很类似，可以被 JSP 文件动态加载调用，但是用户不能直接访问 Tag 文件。</p>
</div></div>
</li>
<li><p><strong>Tag 文件应当存放在怎样的目录中？</strong></p>
<div class="hide-block"><button type="button" class="hide-button" style="background-color:  green;">查看答案
    </button><div class="hide-content"><p>答：Tag 文件的保存位置为：WEB-INF 目录下的 tags 目录及其子目录中。</p>
</div></div>
</li>
<li><p><strong>Tag 文件中的 <code>tag</code> 指令可以设置哪些属性的值？</strong></p>
<div class="hide-block"><button type="button" class="hide-button" style="background-color:  green;">查看答案
    </button><div class="hide-content"><p>答：<code>tag</code> 指令可以设置 <code>pageEncoding</code>、<code>language</code>、<code>import</code> 等属性的值。</p>
</div></div>
</li>
<li><p><strong>Tag 文件中的 <code>attribute</code> 指令有怎样的作用？</strong></p>
<div class="hide-block"><button type="button" class="hide-button" style="background-color:  green;">查看答案
    </button><div class="hide-content"><p>答：在 Tag 文件中通过使用 <code>attribute</code> 指令让使用它的 JSP 页面向该 Tag 文件传递需要的数据。</p>
</div></div>
</li>
<li><p><strong>Tag 文件中的 <code>variable</code> 指令有怎样的作用？</strong></p>
<div class="hide-block"><button type="button" class="hide-button" style="background-color:  green;">查看答案
    </button><div class="hide-content"><p>答：Tag 文件通过使用 <code>variable</code> 指令可以将 Tag 文件中的对象返回给调用该 Tag 文件的 JSP 页面。</p>
</div></div>
</li>
<li><p><strong>编写两个 Tag 文件 <code>Rect.tag</code> 和 <code>Circle.tag</code>。<code>Rect.tag</code> 负责计算并显示矩形的面积，<code>Circle.tag</code> 负责计算并显示圆的面积。编写一个 JSP 页面 <code>lianxi6.jsp</code>，该 JSP 页面使用 Tag 标记调用 <code>Rect.tag</code> 和 <code>Circle.tag</code>。调用 <code>Rect.tag</code> 时，向其传递矩形的两个边的长度；调用 <code>Circle.tag</code> 时，向其传递圆的半径。</strong></p>
<div class="hide-block"><button type="button" class="hide-button" style="background-color:  green;">查看答案
    </button><div class="hide-content"><p>答：代码如下：</p>
<p><strong>Rect.tag</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ tag pageEncoding=&quot;utf-8&quot; %&gt;</span><br><span class="line">&lt;%@ attribute name=&quot;sideA&quot; required=&quot;true&quot; %&gt;</span><br><span class="line">&lt;%@ attribute name=&quot;sideB&quot; required=&quot;true&quot; %&gt;</span><br><span class="line">&lt;%@ variable name-given=&quot;area1&quot; variable-class=&quot;java.lang.Double&quot; scope=&quot;AT_END&quot; %&gt;</span><br><span class="line">&lt;%!</span><br><span class="line">    public double getArea(double a, double b) &#123;</span><br><span class="line">        if (a &gt; 0 &amp;&amp; b &gt; 0) &#123;</span><br><span class="line">            double area = a * b;</span><br><span class="line">            return area;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return -1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    try &#123;</span><br><span class="line">        double a = Double.parseDouble(sideA);</span><br><span class="line">        double b = Double.parseDouble(sideB);</span><br><span class="line">        double result = getArea(a, b);</span><br><span class="line">        jspContext.setAttribute(&quot;area1&quot;, new Double(result));</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        jspContext.setAttribute(&quot;area1&quot;, new Double(-1.0));</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p><strong>Circle.tag</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ tag pageEncoding=&quot;utf-8&quot; %&gt;</span><br><span class="line">&lt;%@ attribute name=&quot;radius&quot; required=&quot;true&quot; %&gt;</span><br><span class="line">&lt;%@ variable name-given=&quot;area2&quot; variable-class=&quot;java.lang.Double&quot; scope=&quot;AT_END&quot; %&gt;</span><br><span class="line">&lt;%!</span><br><span class="line">    public double getArea(double r) &#123;</span><br><span class="line">        if (r &gt; 0) &#123;</span><br><span class="line">            double area = Math.PI * r * r;</span><br><span class="line">            return area;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return -1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    try &#123;</span><br><span class="line">        double r = Double.parseDouble(radius);</span><br><span class="line">        double result1 = getArea(r);</span><br><span class="line">        jspContext.setAttribute(&quot;area2&quot;, new Double(result1));</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        jspContext.setAttribute(&quot;area2&quot;, new Double(-1.0));</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p><strong>Lianxi6.jsp</strong></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib tagdir=<span class="string">&quot;/WEB-INF/tags/test_3_6&quot;</span> prefix=<span class="string">&quot;computer&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;&quot;</span> method=get name=form&gt;</span><br><span class="line">    &lt;h3&gt;请输入矩形的长宽和圆的半径：&lt;/h3&gt;</span><br><span class="line">    &lt;table&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;长：&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;a&quot;</span>&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;宽：&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;b&quot;</span>&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;半径：&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;r&quot;</span>&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">    &lt;br&gt;&lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;计算&quot;</span> name=submit&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="type">String</span> <span class="variable">a</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">b</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">r</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="literal">null</span> || b == <span class="literal">null</span> || r == <span class="literal">null</span>) &#123;</span><br><span class="line">        a = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">        b = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">        r = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (a.length() &gt; <span class="number">0</span> &amp;&amp; b.length() &gt; <span class="number">0</span> &amp;&amp; r.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">%&gt;</span><br><span class="line">    &lt;computer:Rect sideA=<span class="string">&quot;&lt;%=a%&gt;&quot;</span> sideB=<span class="string">&quot;&lt;%=b%&gt;&quot;</span> /&gt;</span><br><span class="line">    &lt;computer:Circle radius=<span class="string">&quot;&lt;%=r%&gt;&quot;</span> /&gt;</span><br><span class="line">    &lt;br&gt;矩形面积：</span><br><span class="line">    &lt;br&gt;&lt;%=area1%&gt;</span><br><span class="line">    &lt;br&gt;圆形面积：</span><br><span class="line">    &lt;br&gt;&lt;%=area2%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>运行截图：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.imgdb.cn/item/64d2e0c41ddac507cca4c87d.png" alt="3-1 计算矩形和圆的面积"></p>
</div></div>
</li>
<li><p><strong>编写一个 Tag 文件：<code>GetArea.tag</code> 负责求出三角形的面积，并使用 <code>variable</code> 指令返回三角形的面积给调用该 Tag 文件的 JSP 页面。 JSP 页面负责显示 Tag 文件返回的三角形的面积。 JSP 在调用 Tag 文件时，使用 <code>attribute</code> 指令将三角形三边的长度传递给 Tag 文件。<code>one.jsp</code> 和 <code>two.jsp</code> 都使用 Tag 标记调用 <code>GetArea.tag</code>。<code>one.jsp</code> 返回的三角形的面积保留最多 3 位小数，<code>two.jsp</code> 返回的三角形的面积保留最多 6 位小数。</strong></p>
<div class="hide-block"><button type="button" class="hide-button" style="background-color:  green;">查看答案
    </button><div class="hide-content"><p>答：代码如下：</p>
<p><strong>one.jsp</strong></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.text.*&quot;</span> %&gt;</span><br><span class="line">&lt;%@ taglib tagdir=<span class="string">&quot;/WEB-INF/tags/test_3_7&quot;</span> prefix=<span class="string">&quot;computer&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;form action=<span class="string">&quot;&quot;</span> method=get name=form&gt;</span><br><span class="line">            &lt;h3&gt;请输入三角形三边长：&lt;/h3&gt;</span><br><span class="line">            &lt;table&gt;</span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                    &lt;td&gt;a：&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;a&quot;</span>&gt;&lt;/td&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                    &lt;td&gt;b：&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;b&quot;</span>&gt;&lt;/td&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                    &lt;td&gt;c：&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;c&quot;</span>&gt;&lt;/td&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">            &lt;/table&gt;</span><br><span class="line">            &lt;br&gt;&lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;计算结果最多保留 3 位小数&quot;</span> name=submit&gt;</span><br><span class="line">            &lt;%</span><br><span class="line">                String a=request.getParameter(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">                String b=request.getParameter(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">                String c=request.getParameter(<span class="string">&quot;c&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (a == <span class="literal">null</span> || b == <span class="literal">null</span> || c == <span class="literal">null</span>) &#123;</span><br><span class="line">                    a = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">                    b = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">                    c = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (a.length() &gt; <span class="number">0</span> &amp;&amp; b.length() &gt; <span class="number">0</span> &amp;&amp; c.length()&gt;<span class="number">0</span>) &#123;</span><br><span class="line">            %&gt;</span><br><span class="line">                    &lt;computer:GetArea sideA=<span class="string">&quot;&lt;%=a%&gt;&quot;</span> sideB=<span class="string">&quot;&lt;%=b%&gt;&quot;</span> sideC=<span class="string">&quot;&lt;%=c%&gt;&quot;</span> /&gt;</span><br><span class="line">            &lt;%</span><br><span class="line">                    NumberFormat f=NumberFormat.getInstance();</span><br><span class="line">                    f.setMaximumFractionDigits(<span class="number">3</span>);</span><br><span class="line">                    <span class="type">double</span> result=area.doubleValue();</span><br><span class="line">                    String str=f.format(result);</span><br><span class="line">                    out.println(str);</span><br><span class="line">                &#125;</span><br><span class="line">            %&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><strong>two.jsp</strong></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.text.*&quot;</span> %&gt;</span><br><span class="line">&lt;%@ taglib tagdir=<span class="string">&quot;/WEB-INF/tags/test_3_7&quot;</span> prefix=<span class="string">&quot;computer&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;form action=<span class="string">&quot;&quot;</span> method=get name=form&gt;</span><br><span class="line">            &lt;h3&gt;请输入三角形三边长：&lt;/h3&gt;</span><br><span class="line">            &lt;table&gt;</span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                    &lt;td&gt;a：&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;a&quot;</span>&gt;&lt;/td&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                    &lt;td&gt;b：&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;b&quot;</span>&gt;&lt;/td&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                    &lt;td&gt;c：&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;c&quot;</span>&gt;&lt;/td&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">            &lt;/table&gt;</span><br><span class="line">            &lt;br&gt; &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;计算结果最多保留 6 位小数&quot;</span> name=submit&gt;</span><br><span class="line">            &lt;% </span><br><span class="line">                <span class="type">String</span> <span class="variable">a</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">b</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">c</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;c&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (a == <span class="literal">null</span> || b == <span class="literal">null</span> || c == <span class="literal">null</span>) &#123;</span><br><span class="line">                    a = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">                    b = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">                    c = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (a.length() &gt; <span class="number">0</span> &amp;&amp; b.length() &gt; <span class="number">0</span> &amp;&amp; c.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            %&gt;</span><br><span class="line">                    &lt;computer:GetArea sideA=<span class="string">&quot;&lt;%=a%&gt;&quot;</span> sideB=<span class="string">&quot;&lt;%=b%&gt;&quot;</span> sideC=<span class="string">&quot;&lt;%=c%&gt;&quot;</span> /&gt;</span><br><span class="line">            &lt;%</span><br><span class="line">                    <span class="type">NumberFormat</span> <span class="variable">f</span> <span class="operator">=</span> NumberFormat.getInstance();</span><br><span class="line">                    f.setMaximumFractionDigits(<span class="number">6</span>);</span><br><span class="line">                    <span class="type">double</span> <span class="variable">result</span> <span class="operator">=</span> area.doubleValue();</span><br><span class="line">                    <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> f.format(result);</span><br><span class="line">                    out.println(str);</span><br><span class="line">                &#125;</span><br><span class="line">            %&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><strong>GetArea.tag</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ tag pageEncoding=&quot;utf-8&quot; %&gt;</span><br><span class="line">&lt;%@ attribute name=&quot;sideA&quot; required=&quot;true&quot; %&gt;</span><br><span class="line">&lt;%@ attribute name=&quot;sideB&quot; required=&quot;true&quot; %&gt;</span><br><span class="line">&lt;%@ attribute name=&quot;sideC&quot; required=&quot;true&quot; %&gt;</span><br><span class="line">&lt;%@ variable name-given=&quot;area&quot; variable-class=&quot;java.lang.Double&quot; scope=&quot;AT_END&quot; %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    double a = Double.parseDouble(sideA);</span><br><span class="line">    double b = Double.parseDouble(sideB);</span><br><span class="line">    double c = Double.parseDouble(sideC);</span><br><span class="line">    if (a + b &gt; c &amp;&amp; a + c &gt; b &amp;&amp; c + b &gt; a) &#123;</span><br><span class="line">        double p = (a + b + c) / 2.0;</span><br><span class="line">        double area = Math.sqrt(p * (p - a) * (p - b) * (p - c));</span><br><span class="line">        jspContext.setAttribute(&quot;area&quot;,new Double(area));</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        jspContext.setAttribute(&quot;area&quot;,new Double(-1));</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>运行截图：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.imgdb.cn/item/64d2e58f1ddac507ccace5b9.png" alt="3-2 计算三角形面积"></p>
</div></div></li>
</ol>
<hr>
<a class="btn-anzhiyu " href="/note/note_3_backend/3.jsp/index" 
  title="返回目录"><span>返回目录</span></a>

<a class="btn-anzhiyu " href="/note/note_3_backend/3.jsp/2" 
  title="上一章"><span>上一章</span></a>

<a class="btn-anzhiyu " href="/note/note_3_backend/3.jsp/4" 
  title="下一章"><span>下一章</span></a>
</div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.imgdb.cn/item/64f97fcf661c6c8e544e533e.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.imgdb.cn/item/64f98091661c6c8e544e8403.webp" ait="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">邸浩哲Geo</h1><div class="author-info__desc">热爱可抵岁月漫长</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="mailto:dihaozhe@outlook.com" target="_blank" title="Email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="social-icon faa-parent animated-hover" href="https://github.com/dihaozhe-365" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://pic.imgdb.cn/item/64f98092661c6c8e544e84cd.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://pic.imgdb.cn/item/64f98092661c6c8e544e84d9.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-Tag-%E6%96%87%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">3.1 Tag 文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tag-%E6%96%87%E4%BB%B6%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text">Tag 文件的结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tag-%E6%96%87%E4%BB%B6%E7%9A%84%E4%BF%9D%E5%AD%98"><span class="toc-number">1.2.</span> <span class="toc-text">Tag 文件的保存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-Tag-%E6%A0%87%E8%AE%B0"><span class="toc-number">2.</span> <span class="toc-text">3.2 Tag 标记</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tag-%E6%A0%87%E8%AE%B0%E4%B8%8E-Tag-%E6%96%87%E4%BB%B6"><span class="toc-number">2.1.</span> <span class="toc-text">Tag 标记与 Tag 文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tag-%E6%A0%87%E8%AE%B0%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.2.</span> <span class="toc-text">Tag 标记的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tag-%E6%A0%87%E8%AE%B0%E7%9A%84%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86"><span class="toc-number">2.3.</span> <span class="toc-text">Tag 标记的运行原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-Tag-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4"><span class="toc-number">3.</span> <span class="toc-text">3.3 Tag 文件中的常用指令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tag-%E6%8C%87%E4%BB%A4"><span class="toc-number">3.1.</span> <span class="toc-text">tag 指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#include-%E6%8C%87%E4%BB%A4"><span class="toc-number">3.2.</span> <span class="toc-text">include 指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#attribute-%E6%8C%87%E4%BB%A4"><span class="toc-number">3.3.</span> <span class="toc-text">attribute 指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#variable-%E6%8C%87%E4%BB%A4"><span class="toc-number">3.4.</span> <span class="toc-text">variable 指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#taglib-%E6%8C%87%E4%BB%A4"><span class="toc-number">3.5.</span> <span class="toc-text">taglib 指令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%A0%E9%A2%98-3"><span class="toc-number">4.</span> <span class="toc-text">习题 3</span></a></li></ol></div></div><div class="card-widget"><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/IDEA/" style="font-size: 1.05rem;">IDEA<sup>1</sup></a><a href="/tags/IDEA-%E6%8F%92%E4%BB%B6/" style="font-size: 1.05rem;">IDEA 插件<sup>1</sup></a><a href="/tags/JDK/" style="font-size: 1.05rem;">JDK<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>1</sup></a><a href="/tags/Tomcat/" style="font-size: 1.05rem;">Tomcat<sup>1</sup></a><a href="/tags/%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" style="font-size: 1.05rem;">安装教程<sup>2</sup></a><a href="/tags/%E8%8B%B1%E8%AF%AD%E6%96%87%E5%AD%A6/" style="font-size: 1.05rem;">英语文学<sup>1</sup></a></div></div><hr/><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li></ul></div><hr/><div class="card-webinfo"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="webinfo-item-title"><i class="anzhiyufont anzhiyu-icon-file-lines"></i><div class="item-name">文章总数 :</div></div><div class="item-count">4</div></div><div class="webinfo-item"><div class="webinfo-item-title"><i class="anzhiyufont anzhiyu-icon-stopwatch"></i><div class="item-name">建站天数 :</div></div><div class="item-count" id="runtimeshow" data-publishDate="2023-07-06T16:00:00.000Z"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></div></div><div class="webinfo-item"><div class="webinfo-item-title"><i class="anzhiyufont anzhiyu-icon-font"></i><div class="item-name">全站字数 :</div></div><div class="item-count">3.6k</div></div><div class="webinfo-item"><div class="webinfo-item-title"><i class="anzhiyufont anzhiyu-icon-universal-access"></i><div class="item-name">总访客数 :</div></div><div class="item-count" id="busuanzi_value_site_uv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></div></div><div class="webinfo-item"><div class="webinfo-item-title"><i class="anzhiyufont anzhiyu-icon-square-poll-vertical"></i><div class="item-name">总访问量 :</div></div><div class="item-count" id="busuanzi_value_site_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></div></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:dihaozhe@outlook.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/dihaozhe-365" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" href="tencent://message/?uin=1839279043&amp;Site=&amp;Menu=yes" title="QQ"><i class="anzhiyufont anzhiyu-icon-qq"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.imgdb.cn/item/64f97fcf661c6c8e544e533e.jpg" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/629900379" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.douyin.com/user/MS4wLjABAAAAGDgnLwA_rPyo8wJ-uBXtGfaMMmcqp9j3z9lygqF4ZS4" title="抖音"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a><a class="deal_link" href="/copyright" title="CC"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="51la 统计" target="_blank" rel="noopener" href="https://v6.51.la/">51la 统计</a><a class="footer-item" title="聚合图床" target="_blank" rel="noopener" href="https://www.superbed.cn/">聚合图床</a><a class="footer-item" title="开往" target="_blank" rel="noopener" href="https://github.com/travellings-link/travellings">开往</a></div></div><div class="footer-group"><div class="footer-title">文库</div><div class="footer-links"><a class="footer-item" title="文章总览" href="/archives/">文章总览</a><a class="footer-item" title="全部分类" href="/categories/">全部分类</a><a class="footer-item" title="全部标签" href="/tags/">全部标签</a></div></div><div class="footer-group"><div class="footer-title">学习</div><div class="footer-links"><a class="footer-item" title="笔记仓库" href="/note/">笔记仓库</a></div></div><div class="footer-group"><div class="footer-title">生活</div><div class="footer-links"><a class="footer-item" title="音乐馆" href="/music/">音乐馆</a></div></div><div class="footer-group"><div class="footer-title">社交</div><div class="footer-links"><a class="footer-item" title="友情链接" href="/link/">友情链接</a><a class="footer-item" title="到此一游" href="/comments/">到此一游</a><a class="footer-item" title="即刻短文" href="/essay/">即刻短文</a></div></div><div class="footer-group"><div class="footer-title">站长</div><div class="footer-links"><a class="footer-item" title="我的装备" href="/equipment/">我的装备</a><a class="footer-item" title="关于本人" href="/about/">关于本人</a></div></div><div class="footer-group"><div class="footer-title">协议</div><div class="footer-links"><a class="footer-item" title="隐私协议" href="/privacy/">隐私协议</a><a class="footer-item" title="Cookies 协议" href="/cookies/">Cookies 协议</a><a class="footer-item" title="版权协议" href="/copyright/">版权协议</a></div></div></div><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/footer/邸浩哲-上班摸鱼中.svg" alt="距离月入 25 k也就还差一个大佬带我~" title="距离月入 25 k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://www.dogecloud.com/" style="margin-inline:5px" data-title="本站使用多吉云为静态资源提供CDN加速" title="本站使用多吉云为静态资源提供CDN加速"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/CDN-多吉云-3693F3.svg" alt="本站使用多吉云为静态资源提供CDN加速"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="本站项目由Github托管"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2023 By 邸浩哲Geo </div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/" title="冀ICP备-2023021272号">冀ICP备-2023021272号</a><a class="footer-bar-link cc" href="/copyright" title="cc协议"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">3</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网站</div><div class="back-menu-list"><a class="back-menu-item" href="https://dihaozhe.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.imgdb.cn/item/64f98091661c6c8e544e8413.webp" alt="博客"/><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="http://star-di.com:8080/BasedOnWebProgramming_war_exploded/" title="JSP 程序设计"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic.imgdb.cn/item/65016a12661c6c8e546c4a0e.webp" alt="JSP 程序设计"/><span class="back-menu-item-text">JSP 程序设计</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文库</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 文章总览</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 全部分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 学习</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/note/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 笔记仓库</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 生活</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=9013145695&amp;server=tencent"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 社交</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友情链接</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-shoe-prints faa-tada" style="font-size: 0.9em;"></i><span> 到此一游</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-bullhorn faa-tada" style="font-size: 0.9em;"></i><span> 即刻短文</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-keyboard faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/IDEA/" style="font-size: 0.88rem;">IDEA<sup>1</sup></a><a href="/tags/IDEA-%E6%8F%92%E4%BB%B6/" style="font-size: 0.88rem;">IDEA 插件<sup>1</sup></a><a href="/tags/JDK/" style="font-size: 0.88rem;">JDK<sup>1</sup></a><a href="/tags/Java/" style="font-size: 0.88rem;">Java<sup>1</sup></a><a href="/tags/Tomcat/" style="font-size: 0.88rem;">Tomcat<sup>1</sup></a><a href="/tags/%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" style="font-size: 0.88rem;">安装教程<sup>2</sup></a><a href="/tags/%E8%8B%B1%E8%AF%AD%E6%96%87%E5%AD%A6/" style="font-size: 0.88rem;">英语文学<sup>1</sup></a></div></div><hr/></div></div><div id="keyboard-tips"><div class="keyboardTitle">博客快捷键</div><div class="keybordList"><div class="keybordItem"><div class="keyGroup"><div class="key">shift K</div></div><div class="keyContent"><div class="content">关闭快捷键功能</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift A</div></div><div class="keyContent"><div class="content">打开/关闭中控台</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift M</div></div><div class="keyContent"><div class="content">播放/暂停音乐</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift D</div></div><div class="keyContent"><div class="content">深色/浅色显示模式</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift S</div></div><div class="keyContent"><div class="content">站内搜索</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift R</div></div><div class="keyContent"><div class="content">随机访问</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift H</div></div><div class="keyContent"><div class="content">返回首页</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift L</div></div><div class="keyContent"><div class="content">友链页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift P</div></div><div class="keyContent"><div class="content">关于本站</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift I</div></div><div class="keyContent"><div class="content">原版/本站右键菜单</div></div></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="开关弹幕"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="9013145695" server="tencent" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/9013145695&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.4/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>var meting_api = "https://meting.qjqq.cn/?server=:server&type=:type&id=:id&auth=:auth&r=:r";
</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("07/07/2023 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎访问邸浩哲Geo!`,
    `热爱可抵岁月漫长`,
    `
      ───────────────────────────────────────────────────────────────────────────────
      ─██████████████─██████████████─██████████████────────████████████───██████████─
      ─██░░░░░░░░░░██─██░░░░░░░░░░██─██░░░░░░░░░░██────────██░░░░░░░░████─██░░░░░░██─
      ─██░░██████████─██░░██████████─██░░██████░░██────────██░░████░░░░██─████░░████─
      ─██░░██─────────██░░██████████─██░░██──██░░██────────██░░██──██░░██───██░░██───
      ─██░░██──██████─██░░░░░░░░░░██─██░░██──██░░██────────██░░██──██░░██───██░░██───
      ─██░░██──██░░██─██░░██████████─██░░██──██░░██────────██░░██──██░░██───██░░██───
      ─██░░██████░░██─██░░██████████─██░░██████░░██─██████─██░░████░░░░██─████░░████─
      ─██░░░░░░░░░░██─██░░░░░░░░░░██─██░░░░░░░░░░██─██░░██─██░░░░░░░░████─██░░░░░░██─
      ─██████████████─██████████████─██████████████─██████─████████████───██████████─
      ───────────────────────────────────────────────────────────────────────────────
        `,
    "已上线",
    dnum,
    "天",
    "©2023 By 邸浩哲Geo V1.6.5",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 邸浩哲 %c 你正在访问 邸浩哲Geo 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("07/07/2023 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"邸浩哲-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站已经艰难运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"邸浩哲-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      img.src = "/img/footer/邸浩哲-下班啦.svg";
      img.title = "下班了就该开开心心的玩耍，嘿嘿~";
      img.alt = "下班了就该开开心心的玩耍，嘿嘿~";

      currentTimeHtml = `本站已经艰难运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.56.5/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.cbd.int/mermaid@10.2.4/dist/mermaid.min.js').then(runMermaid)
  }

  anzhiyu.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><input type="hidden" name="page-type" id="page-type" value="anzhiyu"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://dihaozhe.zeabur.app',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.18/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "visitor@dihaozhe.com";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>